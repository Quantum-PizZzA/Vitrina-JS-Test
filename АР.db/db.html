<html>
<head>
<title>VITRINA SQL</title>
<script>

db = openDatabase("VITRINA", "0.1", "Online Show Case Table", 200000);

if (!db)
  document.write("<h2>ERROR OPEN!!!</h2>");

//    document.write("<h2>123</h2>");

db.transaction(function(tx)
    {
    tx.executeSql("SELECT COUNT(*) AS c FROM Showcase", [], function (result, r)
      {
//      document.write("<h2>");
//      document.write(r.rows[0].c);
//      document.write("</h2>");
      },
    function (tx, error)
        {
        tx.executeSql("CREATE TABLE Showcase (id REAL UNIQUE, ean INT, name TEXT, price REAL, timestamp REAL)", [], null, null);
        })
    });

db.transaction(function(tx)
    {
//    document.write("<h2>789</h2>");
//    tx.executeSql("INSERT INTO PriceBoard (ean, price) values(?, ?)", ["4627145075203", 69.90], null, null);
//    tx.executeSql("INSERT INTO PriceBoard (ean, price) values(?, ?)", ["5449000098542", 149.90], null, null);
    tx.executeSql("INSERT INTO Showcase (ean, name, price, timestamp) values(?, ?, ?, ?)", ["4607144738088", "Cookies", 20.90, new Date().getTime()], null, null);
    });

db.transaction(function(tx)
    {
//    document.write("<h2>abc</h2>");
//    tx.executeSql("SELECT * FROM Showcase", [], function(tx, result)
    tx.executeSql("SELECT ean, name, MIN(price) AS minp, MAX(price) AS maxp FROM Showcase GROUP BY(ean)", [], function(tx, result)
        {
        for(var i = 0; i < result.rows.length; i++)
          {
          //document.write('<b>' + result.rows.item(i)['ean'] + '<br />');
          document.write('<b>' + result.rows.item(i)['ean'] + '</b> '+ result.rows.item(i)['name'] +' ('+ result.rows.item(i)['minp'] +' - '+ result.rows.item(i)['maxp'] +')<br />');
          }
        }, null)
    });
/**/
//document.write("<h2>xyz</h2>");

</script>
</head>
<!--
Данный код создаёт объект, представляющий БД,
а если базы данных с таким именем не существует, то создаётся и она.
При этом в аргументах указывается имя базы данных, версия,
 отображаемое имя и приблизительный размер.
Кроме того важно отметить, что приблизительный размер не является
 ограничением.
Реальный размер базы данных может изменяться.
Успешность подключения к БД можно оценить, проверив объект db на null:
-->
<body>
<h1>qqq</h1>


</body>
</html>
