<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Чтение файла</title>
  </head>
  <body>
    <input type="file" id="file" />
    <button>Чтение файла</button>

    <script>
      document.querySelector("button").addEventListener("click", function () {
        let file = document.getElementById("file").files[0];

        let reader = new FileReader();

        reader.readAsText(file);

        reader.onload = function () {
          console.log(reader.result);

          let MASS = reader.result;

          const matrix = MASS.split("\n");

          let sum = 0;

          let Num = 0; //первое число

          let matrix2 = []

          for (
            let i = 0;
            i < matrix.length.toString() &&
            matrix[i] != "NaN" &&
            matrix[i] != "\r" &&
            matrix[i] != "";
            i++
          ) {
            sum = sum + Number(matrix[i]);
            Num ++
            console.log("matrix[",i,"] = ", matrix[i])
            matrix2[i]= Number(matrix[i])
            
          }
          console.log("sum = ", sum);
          console.log("Матрица 1 = ", matrix);
          console.log("Матрица 2 = ", matrix2);

          var arr = matrix2;
          // Функции сортировки
          function sIncrease(i, ii) {
            // По возрастанию
            if (i > ii) return 1;
            else if (i < ii) return -1;
            else return 0;
          }
          arr.sort(sIncrease);


          // hashCode
            function hashCode(str) {
            return str
              .split("")
              .reduce(
                (prevHash, currVal) =>
                  ((prevHash << 5) - prevHash + currVal.charCodeAt(0)) | 0,
                0
              );
          }

          console.log("Сортировка = ", arr.sort(sIncrease));

          Hash = ""+Num;

          for (let i = 0; i < arr.sort(sIncrease).length; i++) {
            Hash = Hash + arr.sort(sIncrease)[i];
            
          }
          console.log(Hash);
          console.log("Штрих код от (",Hash, ") =",hashCode(Hash));

          localStorage.setItem(hashCode(Hash), matrix2);


        };

        // reader.onerror = function () {
        //   console.log(reader.error);
        // };
      });
    </script>
  </body>
</html>
